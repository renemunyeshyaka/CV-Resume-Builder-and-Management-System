(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[444],{4139:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/manage-users",function(){return r(4273)}])},4273:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return l}});var d=r(5893),i=r(7294),o=r(1163),n=r(7066);let a="http://localhost:4000";function l(){let e=(0,o.useRouter)(),[t,r]=(0,i.useState)([]),[l,s]=(0,i.useState)(!0),[c,p]=(0,i.useState)(""),[x,u]=(0,i.useState)("all"),[h,g]=(0,i.useState)(!1),[y,b]=(0,i.useState)(!1),[m,f]=(0,i.useState)(null),[v,j]=(0,i.useState)({name:"",email:"",password:"",role:"user"}),[w,k]=(0,i.useState)({text:"",type:""});(0,i.useEffect)(()=>{S()},[]);let S=async()=>{let t=localStorage.getItem("token");if(!t){e.push("/login");return}try{let e=await n.Z.get("".concat(a,"/api/admin/users"),{headers:{Authorization:"Bearer ".concat(t)}});r(e.data),s(!1)}catch(e){console.error("Error fetching users:",e),C("Failed to fetch users","error"),s(!1)}},C=(e,t)=>{k({text:e,type:t}),setTimeout(()=>k({text:"",type:""}),3e3)},R=async e=>{e.preventDefault();let t=localStorage.getItem("token");try{await n.Z.post("".concat(a,"/api/admin/users"),v,{headers:{Authorization:"Bearer ".concat(t)}}),C("User added successfully","success"),g(!1),j({name:"",email:"",password:"",role:"user"}),S()}catch(e){var r,d;C((null===(d=e.response)||void 0===d?void 0:null===(r=d.data)||void 0===r?void 0:r.error)||"Failed to add user","error")}},z=async e=>{e.preventDefault();let t=localStorage.getItem("token");try{await n.Z.put("".concat(a,"/api/admin/users/").concat(m.id),m,{headers:{Authorization:"Bearer ".concat(t)}}),C("User updated successfully","success"),b(!1),f(null),S()}catch(e){var r,d;C((null===(d=e.response)||void 0===d?void 0:null===(r=d.data)||void 0===r?void 0:r.error)||"Failed to update user","error")}},A=async e=>{if(!confirm("Are you sure you want to delete this user? This action cannot be undone."))return;let t=localStorage.getItem("token");try{await n.Z.delete("".concat(a,"/api/admin/users/").concat(e),{headers:{Authorization:"Bearer ".concat(t)}}),C("User deleted successfully","success"),S()}catch(e){var r,d;C((null===(d=e.response)||void 0===d?void 0:null===(r=d.data)||void 0===r?void 0:r.error)||"Failed to delete user","error")}},B=async(e,t)=>{let r=localStorage.getItem("token");try{await n.Z.patch("".concat(a,"/api/admin/users/").concat(e,"/toggle-activation"),{active:!t},{headers:{Authorization:"Bearer ".concat(r)}}),C("User ".concat(t?"deactivated":"activated"," successfully"),"success"),S()}catch(e){var d,i;C((null===(i=e.response)||void 0===i?void 0:null===(d=i.data)||void 0===d?void 0:d.error)||"Failed to update user status","error")}},W=t.filter(e=>{var t,r;let d=(null===(t=e.name)||void 0===t?void 0:t.toLowerCase().includes(c.toLowerCase()))||(null===(r=e.email)||void 0===r?void 0:r.toLowerCase().includes(c.toLowerCase())),i="all"===x||e.role===x;return d&&i});return l?(0,d.jsx)("div",{style:{padding:"40px",textAlign:"center"},children:"Loading..."}):(0,d.jsx)("div",{style:{padding:"40px",minHeight:"100vh",background:"#f5f5f5"},children:(0,d.jsxs)("div",{style:{maxWidth:"1400px",margin:"0 auto"},children:[(0,d.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"30px"},children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("h1",{style:{fontSize:"32px",fontWeight:"700",color:"#333",marginBottom:"10px"},children:"Manage Users"}),(0,d.jsx)("button",{onClick:()=>e.push("/admin-dashboard"),style:{background:"none",border:"none",color:"#667eea",cursor:"pointer",fontSize:"14px"},children:"â† Back to Dashboard"})]}),(0,d.jsx)("button",{onClick:()=>g(!0),style:{padding:"12px 24px",background:"#667eea",color:"white",border:"none",borderRadius:"5px",cursor:"pointer",fontWeight:"600"},children:"+ Add User"})]}),w.text&&(0,d.jsx)("div",{style:{padding:"15px",marginBottom:"20px",borderRadius:"5px",background:"success"===w.type?"#d4edda":"#f8d7da",color:"success"===w.type?"#155724":"#721c24",border:"1px solid ".concat("success"===w.type?"#c3e6cb":"#f5c6cb")},children:w.text}),(0,d.jsx)("div",{style:{background:"white",padding:"20px",borderRadius:"10px",marginBottom:"20px",boxShadow:"0 2px 10px rgba(0,0,0,0.1)"},children:(0,d.jsxs)("div",{style:{display:"flex",gap:"15px",flexWrap:"wrap"},children:[(0,d.jsx)("input",{type:"text",placeholder:"Search by name or email...",value:c,onChange:e=>p(e.target.value),style:{flex:"1",minWidth:"250px",padding:"10px",border:"1px solid #ddd",borderRadius:"5px",fontSize:"14px"}}),(0,d.jsxs)("select",{value:x,onChange:e=>u(e.target.value),style:{padding:"10px",border:"1px solid #ddd",borderRadius:"5px",fontSize:"14px",cursor:"pointer"},children:[(0,d.jsx)("option",{value:"all",children:"All Roles"}),(0,d.jsx)("option",{value:"user",children:"User"}),(0,d.jsx)("option",{value:"hr",children:"HR"}),(0,d.jsx)("option",{value:"admin",children:"Admin"})]})]})}),(0,d.jsx)("div",{style:{background:"white",borderRadius:"10px",boxShadow:"0 2px 10px rgba(0,0,0,0.1)",overflow:"hidden"},children:(0,d.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse"},children:[(0,d.jsx)("thead",{style:{background:"#f8f9fa"},children:(0,d.jsxs)("tr",{children:[(0,d.jsx)("th",{style:{padding:"15px",textAlign:"left",fontWeight:"600",color:"#333"},children:"Name"}),(0,d.jsx)("th",{style:{padding:"15px",textAlign:"left",fontWeight:"600",color:"#333"},children:"Email"}),(0,d.jsx)("th",{style:{padding:"15px",textAlign:"left",fontWeight:"600",color:"#333"},children:"Role"}),(0,d.jsx)("th",{style:{padding:"15px",textAlign:"left",fontWeight:"600",color:"#333"},children:"Status"}),(0,d.jsx)("th",{style:{padding:"15px",textAlign:"left",fontWeight:"600",color:"#333"},children:"Created"}),(0,d.jsx)("th",{style:{padding:"15px",textAlign:"center",fontWeight:"600",color:"#333"},children:"Actions"})]})}),(0,d.jsx)("tbody",{children:0===W.length?(0,d.jsx)("tr",{children:(0,d.jsx)("td",{colSpan:"6",style:{padding:"40px",textAlign:"center",color:"#999"},children:"No users found"})}):W.map(e=>(0,d.jsxs)("tr",{style:{borderTop:"1px solid #eee"},children:[(0,d.jsx)("td",{style:{padding:"15px"},children:e.name||"N/A"}),(0,d.jsx)("td",{style:{padding:"15px"},children:e.email}),(0,d.jsx)("td",{style:{padding:"15px"},children:(0,d.jsx)("span",{style:{padding:"4px 12px",borderRadius:"12px",fontSize:"12px",fontWeight:"600",background:"admin"===e.role?"#dc3545":"hr"===e.role?"#ffc107":"#28a745",color:"white"},children:e.role.toUpperCase()})}),(0,d.jsx)("td",{style:{padding:"15px"},children:(0,d.jsx)("span",{style:{padding:"4px 12px",borderRadius:"12px",fontSize:"12px",fontWeight:"600",background:e.active?"#28a745":"#6c757d",color:"white"},children:e.active?"Active":"Inactive"})}),(0,d.jsx)("td",{style:{padding:"15px",fontSize:"14px",color:"#666"},children:new Date(e.created_at).toLocaleDateString()}),(0,d.jsx)("td",{style:{padding:"15px",textAlign:"center"},children:(0,d.jsxs)("div",{style:{display:"flex",gap:"8px",justifyContent:"center"},children:[(0,d.jsx)("button",{onClick:()=>{f(e),b(!0)},style:{padding:"6px 12px",background:"#667eea",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"12px"},children:"Edit"}),(0,d.jsx)("button",{onClick:()=>B(e.id,e.active),style:{padding:"6px 12px",background:e.active?"#ffc107":"#28a745",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"12px"},children:e.active?"Deactivate":"Activate"}),(0,d.jsx)("button",{onClick:()=>A(e.id),style:{padding:"6px 12px",background:"#dc3545",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"12px"},children:"Delete"})]})})]},e.id))})]})}),h&&(0,d.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:(0,d.jsxs)("div",{style:{background:"white",padding:"30px",borderRadius:"10px",maxWidth:"500px",width:"90%"},children:[(0,d.jsx)("h2",{style:{fontSize:"24px",marginBottom:"20px"},children:"Add New User"}),(0,d.jsxs)("form",{onSubmit:R,children:[(0,d.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,d.jsx)("label",{style:{display:"block",marginBottom:"5px",fontSize:"14px",fontWeight:"600"},children:"Name"}),(0,d.jsx)("input",{type:"text",value:v.name,onChange:e=>j({...v,name:e.target.value}),required:!0,style:{width:"100%",padding:"10px",border:"1px solid #ddd",borderRadius:"5px"}})]}),(0,d.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,d.jsx)("label",{style:{display:"block",marginBottom:"5px",fontSize:"14px",fontWeight:"600"},children:"Email"}),(0,d.jsx)("input",{type:"email",value:v.email,onChange:e=>j({...v,email:e.target.value}),required:!0,style:{width:"100%",padding:"10px",border:"1px solid #ddd",borderRadius:"5px"}})]}),(0,d.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,d.jsx)("label",{style:{display:"block",marginBottom:"5px",fontSize:"14px",fontWeight:"600"},children:"Password"}),(0,d.jsx)("input",{type:"password",value:v.password,onChange:e=>j({...v,password:e.target.value}),required:!0,style:{width:"100%",padding:"10px",border:"1px solid #ddd",borderRadius:"5px"}})]}),(0,d.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,d.jsx)("label",{style:{display:"block",marginBottom:"5px",fontSize:"14px",fontWeight:"600"},children:"Role"}),(0,d.jsxs)("select",{value:v.role,onChange:e=>j({...v,role:e.target.value}),style:{width:"100%",padding:"10px",border:"1px solid #ddd",borderRadius:"5px",cursor:"pointer"},children:[(0,d.jsx)("option",{value:"user",children:"User"}),(0,d.jsx)("option",{value:"hr",children:"HR"}),(0,d.jsx)("option",{value:"admin",children:"Admin"})]})]}),(0,d.jsxs)("div",{style:{display:"flex",gap:"10px",justifyContent:"flex-end"},children:[(0,d.jsx)("button",{type:"button",onClick:()=>{g(!1),j({name:"",email:"",password:"",role:"user"})},style:{padding:"10px 20px",background:"#6c757d",color:"white",border:"none",borderRadius:"5px",cursor:"pointer"},children:"Cancel"}),(0,d.jsx)("button",{type:"submit",style:{padding:"10px 20px",background:"#667eea",color:"white",border:"none",borderRadius:"5px",cursor:"pointer"},children:"Add User"})]})]})]})}),y&&m&&(0,d.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:(0,d.jsxs)("div",{style:{background:"white",padding:"30px",borderRadius:"10px",maxWidth:"500px",width:"90%"},children:[(0,d.jsx)("h2",{style:{fontSize:"24px",marginBottom:"20px"},children:"Edit User"}),(0,d.jsxs)("form",{onSubmit:z,children:[(0,d.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,d.jsx)("label",{style:{display:"block",marginBottom:"5px",fontSize:"14px",fontWeight:"600"},children:"Name"}),(0,d.jsx)("input",{type:"text",value:m.name||"",onChange:e=>f({...m,name:e.target.value}),required:!0,style:{width:"100%",padding:"10px",border:"1px solid #ddd",borderRadius:"5px"}})]}),(0,d.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,d.jsx)("label",{style:{display:"block",marginBottom:"5px",fontSize:"14px",fontWeight:"600"},children:"Email"}),(0,d.jsx)("input",{type:"email",value:m.email,onChange:e=>f({...m,email:e.target.value}),required:!0,style:{width:"100%",padding:"10px",border:"1px solid #ddd",borderRadius:"5px"}})]}),(0,d.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,d.jsx)("label",{style:{display:"block",marginBottom:"5px",fontSize:"14px",fontWeight:"600"},children:"Role"}),(0,d.jsxs)("select",{value:m.role,onChange:e=>f({...m,role:e.target.value}),style:{width:"100%",padding:"10px",border:"1px solid #ddd",borderRadius:"5px",cursor:"pointer"},children:[(0,d.jsx)("option",{value:"user",children:"User"}),(0,d.jsx)("option",{value:"hr",children:"HR"}),(0,d.jsx)("option",{value:"admin",children:"Admin"})]})]}),(0,d.jsxs)("div",{style:{display:"flex",gap:"10px",justifyContent:"flex-end"},children:[(0,d.jsx)("button",{type:"button",onClick:()=>{b(!1),f(null)},style:{padding:"10px 20px",background:"#6c757d",color:"white",border:"none",borderRadius:"5px",cursor:"pointer"},children:"Cancel"}),(0,d.jsx)("button",{type:"submit",style:{padding:"10px 20px",background:"#667eea",color:"white",border:"none",borderRadius:"5px",cursor:"pointer"},children:"Update User"})]})]})]})})]})})}},1163:function(e,t,r){e.exports=r(3079)}},function(e){e.O(0,[66,888,774,179],function(){return e(e.s=4139)}),_N_E=e.O()}]);